{"remainingRequest":"/Users/jameshsu/Documents/itunes-search-master/node_modules/babel-loader/lib/index.js!/Users/jameshsu/Documents/itunes-search-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/jameshsu/Documents/itunes-search-master/src/components/iTunesSearchAPI.js","dependencies":[{"path":"/Users/jameshsu/Documents/itunes-search-master/src/components/iTunesSearchAPI.js","mtime":1564293037316},{"path":"/Users/jameshsu/Documents/itunes-search-master/node_modules/cache-loader/dist/cjs.js","mtime":1564287323436},{"path":"/Users/jameshsu/Documents/itunes-search-master/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jameshsu/Documents/itunes-search-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var _require = require('httpreq'),\n    doRequest = _require.doRequest;\n\nvar _require2 = require('es6-promisify'),\n    promisify = _require2.promisify;\n\nvar config = {\n  timeout: 5000,\n  idKeys: ['amgAlbumId', 'amgArtistId', 'amgVideoId', 'id', 'isbn', 'upc']\n};\n/**\n * Check if one of the keys is a property\n *\n * @return  {boolean}        `true` = yes\n *\n * @param   {array}    keys  Property names to check\n * @param   {object}   obj   Object to process\n */\n\nfunction keysInObject(keys, obj) {\n  var i = 0;\n\n  for (i; i < keys.length; i++) {\n    if (obj[keys[i]]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\n * Callback a request error\n *\n * @callback  callback\n * @return    {Error}   error\n *\n * @param     {error}   err      The error to include in `.error`\n * @param     {object}  res      Response details from httpreq\n * @param     {string}  message  Error message to report\n */\n\n\nfunction httpError(err, res, message) {\n  var error = new Error(message);\n  error.code = res && res.statusCode;\n  error.body = res && res.body;\n  error.error = err;\n  return error;\n}\n/**\n * Process HTTP response\n *\n * @callback  callback\n * @return    {void}\n *\n * @param     {Error|null}  err                  Client error\n * @param     {object}      [res]                Response details\n * @param     {function}    [callback]           `(err, data)`\n * @param     {bool}        [firstResult=false]  Call back only first result\n */\n\n\nfunction httpResponse(err, res, callback, firstResult) {\n  var data = res && res.body || '';\n  var error = null;\n\n  try {\n    data = JSON.parse(data);\n\n    if (!(data.results instanceof Array) || !data.results.length) {\n      error = new Error('no results');\n    } else if (firstResult) {\n      data = data.results[0];\n    }\n  } catch (e) {\n    error = httpError(e, res, 'invalid response');\n  }\n\n  if (err) {\n    error = httpError(err, res, 'http error');\n  }\n\n  if (error) {\n    callback(error);\n  } else {\n    callback(null, data);\n  }\n}\n/**\n * Send HTTP request\n *\n * @callback  callback\n * @return    {void}\n *\n * @param     {object}    props                 Request details\n * @param     {string}    props.url             URL to fetch\n * @param     {object}    props.params          Parameters to send along\n * @param     {int}       [props.timeout=5000]  Wait time out in ms\n * @param     {function}  callback              `(err, data)`\n */\n\n\nfunction httpRequest(props, callback) {\n  var firstResult = false;\n  var options = {\n    url: 'https://itunes.apple.com/search',\n    method: 'GET',\n    parameters: props.params || {},\n    timeout: parseInt(props.timeout || config.timeout, 10),\n    headers: {\n      'Accept': 'application/json',\n      'User-Agent': 'searchitunes.js'\n    }\n  };\n\n  if (keysInObject(config.idKeys, options.parameters)) {\n    options.url = 'https://itunes.apple.com/lookup';\n    firstResult = true;\n  }\n\n  doRequest(options, function (err, res) {\n    httpResponse(err, res, callback, firstResult);\n  });\n}\n/**\n * Module interface\n *\n * @callback  callback\n * @return    {object}                    Promises then & catch\n *\n * @param     {object}    params          Parameters to send to API\n * @param     {int}       [timeout=5000]  Wait time out in ms\n * @param     {function}  callback        `(err, data)`\n */\n\n\nmodule.exports = promisify(function (params, timeout, callback) {\n  var options = {\n    params: params || {}\n  };\n\n  if (typeof timeout === 'function') {\n    callback = timeout;\n    timeout = null;\n  }\n\n  if (!params || !(params instanceof Object)) {\n    callback(new Error('invalid params'));\n    return;\n  }\n\n  options.params.version = params.version || 2;\n  options.timeout = timeout;\n  httpRequest(options, callback);\n});",{"version":3,"sources":["/Users/jameshsu/Documents/itunes-search-master/src/components/iTunesSearchAPI.js"],"names":["require","doRequest","promisify","config","timeout","idKeys","keysInObject","keys","obj","i","length","httpError","err","res","message","error","Error","code","statusCode","body","httpResponse","callback","firstResult","data","JSON","parse","results","Array","e","httpRequest","props","options","url","method","parameters","params","parseInt","headers","module","exports","Object","version"],"mappings":"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","sourcesContent":["const { doRequest } = require ('httpreq');\nconst { promisify } = require ('es6-promisify');\n\nlet config = {\n  timeout: 5000,\n  idKeys: [\n    'amgAlbumId',\n    'amgArtistId',\n    'amgVideoId',\n    'id',\n    'isbn',\n    'upc'\n  ]\n};\n\n\n/**\n * Check if one of the keys is a property\n *\n * @return  {boolean}        `true` = yes\n *\n * @param   {array}    keys  Property names to check\n * @param   {object}   obj   Object to process\n */\n\nfunction keysInObject (keys, obj) {\n  let i = 0;\n\n  for (i; i < keys.length; i++) {\n    if (obj [keys [i]]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n\n/**\n * Callback a request error\n *\n * @callback  callback\n * @return    {Error}   error\n *\n * @param     {error}   err      The error to include in `.error`\n * @param     {object}  res      Response details from httpreq\n * @param     {string}  message  Error message to report\n */\n\nfunction httpError (err, res, message) {\n  let error = new Error (message);\n\n  error.code = res && res.statusCode;\n  error.body = res && res.body;\n  error.error = err;\n\n  return error;\n}\n\n\n/**\n * Process HTTP response\n *\n * @callback  callback\n * @return    {void}\n *\n * @param     {Error|null}  err                  Client error\n * @param     {object}      [res]                Response details\n * @param     {function}    [callback]           `(err, data)`\n * @param     {bool}        [firstResult=false]  Call back only first result\n */\n\nfunction httpResponse (err, res, callback, firstResult) {\n  let data = res && res.body || '';\n  let error = null;\n\n  try {\n    data = JSON.parse (data);\n\n    if (!(data.results instanceof Array) || !data.results.length) {\n      error = new Error ('no results');\n    } else if (firstResult) {\n      data = data.results [0];\n    }\n  } catch (e) {\n    error = httpError (e, res, 'invalid response');\n  }\n\n  if (err) {\n    error = httpError (err, res, 'http error');\n  }\n\n  if (error) {\n    callback (error);\n  } else {\n    callback (null, data);\n  }\n}\n\n\n/**\n * Send HTTP request\n *\n * @callback  callback\n * @return    {void}\n *\n * @param     {object}    props                 Request details\n * @param     {string}    props.url             URL to fetch\n * @param     {object}    props.params          Parameters to send along\n * @param     {int}       [props.timeout=5000]  Wait time out in ms\n * @param     {function}  callback              `(err, data)`\n */\n\nfunction httpRequest (props, callback) {\n  let firstResult = false;\n  let options = {\n    url: 'https://itunes.apple.com/search',\n    method: 'GET',\n    parameters: props.params || {},\n    timeout: parseInt (props.timeout || config.timeout, 10),\n    headers: {\n      'Accept': 'application/json',\n      'User-Agent': 'searchitunes.js'\n    }\n  };\n\n  if (keysInObject (config.idKeys, options.parameters)) {\n    options.url = 'https://itunes.apple.com/lookup';\n    firstResult = true;\n  }\n\n  doRequest (options, (err, res) => {\n    httpResponse (err, res, callback, firstResult);\n  });\n}\n\n\n/**\n * Module interface\n *\n * @callback  callback\n * @return    {object}                    Promises then & catch\n *\n * @param     {object}    params          Parameters to send to API\n * @param     {int}       [timeout=5000]  Wait time out in ms\n * @param     {function}  callback        `(err, data)`\n */\n\nmodule.exports = promisify ((params, timeout, callback) => {\n  let options = {\n    params: params || {}\n  };\n\n  if (typeof timeout === 'function') {\n    callback = timeout;\n    timeout = null;\n  }\n\n  if (!params || !(params instanceof Object)) {\n    callback (new Error ('invalid params'));\n    return;\n  }\n\n  options.params.version = params.version || 2;\n  options.timeout = timeout;\n  httpRequest (options, callback);\n});\n"]}]}